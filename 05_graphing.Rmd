---
title: "workbench"
author: "74465159 Ethan Milne"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
source("03_evaluating.R")
```

# Mock csv file
```{r}

mock_data <- data.frame(
  user_id = 1:150,
  age = sample(18:60, 150, replace = TRUE),
  news = sample(c("Politics", "Sports", "Tech", "Health"), 150, replace = TRUE),
  hobbies = sample(c("Reading", "Sports", "Gaming", "Cooking", "Travel"), 150, replace = TRUE),
  `01_adv_T` = sample(5:10, 150, replace = TRUE),
  `01_adv_F` = sample(0:5, 150, replace = TRUE),
  `01_np_T` = sample(5:10, 150, replace = TRUE),
  `01_np_F` = sample(0:5, 150, replace = TRUE)
)


# Create dummy data: each row represents a sentence
dummy_data <- mock_data

```


```{r}
plot_data <- dummy_data %>%
  pivot_longer(
    cols = c(X01_adv_T, X01_adv_F, X01_np_T, X01_np_F),
    names_to = "phrase_type",
    values_to = "count"
  ) %>%
  mutate(
    correctness = ifelse(str_detect(phrase_type, "_T$"), "Correct", "Incorrect"),
    phrase = case_when(
      str_detect(phrase_type, "adv") ~ "Adverbial Clause",
      str_detect(phrase_type, "np")  ~ "Noun Phrase"
    )
  )

ggplot(plot_data, aes(x = correctness, y = count, fill = phrase)) +
  geom_boxplot() +
  labs(
    title = "Accuracy in Identifying Phrases: Correct vs Incorrect",
    x = "Response Accuracy",
    y = "Count",
    fill = "Phrase Type"
  ) +
  theme_minimal() +
  scale_fill_manual(
    values = c("Adverbial Clause" = "steelblue", "Noun Phrase" = "orange")
  )

```
